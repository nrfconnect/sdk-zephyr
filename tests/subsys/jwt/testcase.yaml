common:
  filter: CONFIG_FULL_LIBC_SUPPORTED
  min_ram: 96
  min_flash: 72
  timeout: 120
  tags: jwt
  integration_platforms:
    - frdm_k64f
  extra_configs:
    - CONFIG_TEST_RANDOM_GENERATOR=y
tests:
  libraries.encoding.jwt.ecdsa.legacy:
    extra_configs:
      - CONFIG_JWT_SIGN_ECDSA=y
      - CONFIG_JWT_USE_LEGACY=y
  libraries.encoding.jwt.ecdsa.psa:
    extra_configs:
      - CONFIG_JWT_SIGN_ECDSA=y
      - CONFIG_JWT_USE_PSA=y
      - CONFIG_MBEDTLS_PSA_CRYPTO_EXTERNAL_RNG=y
      - CONFIG_MBEDTLS_PSA_CRYPTO_EXTERNAL_RNG_ALLOW_NON_CSPRNG=y
  libraries.encoding.jwt.rsa.legacy:
    filter: CSPRNG_ENABLED
    extra_configs:
      - CONFIG_JWT_SIGN_RSA=y
      - CONFIG_JWT_USE_LEGACY=y
  libraries.encoding.jwt.rsa.psa:
    extra_configs:
      - CONFIG_JWT_SIGN_RSA=y
      - CONFIG_JWT_USE_PSA=y
      - CONFIG_MBEDTLS_PSA_CRYPTO_EXTERNAL_RNG=y
      - CONFIG_MBEDTLS_PSA_CRYPTO_EXTERNAL_RNG_ALLOW_NON_CSPRNG=y
