# Copyright (c) 2025 Nordic Semiconductor ASA
# SPDX-License-Identifier: Apache-2.0

config HAS_IRONSIDE_SE
	bool

menu "IronSide SE"
	depends on HAS_IRONSIDE_SE

config IRONSIDE_SE_CALL
	bool "IronSide calls"
	default y
	depends on DT_HAS_NORDIC_IRONSIDE_CALL_ENABLED
	depends on MULTITHREADING
	select EVENTS
	select MBOX
	help
	  Support for IronSide call APIs.

if IRONSIDE_SE_CALL

config IRONSIDE_SE_CALL_INIT_PRIORITY
	int "IronSide calls' driver initialization priority"
	default 41
	help
	  Initialization priority of the IronSide call protocol driver.
	  It must be below MBOX_INIT_PRIORITY, but higher than the priority of any feature
	  that depends on IRONSIDE_SE_CALL.

endif # IRONSIDE_SE_CALL

config IRONSIDE_SE_DVFS
	bool "DVFS support"
	depends on SOC_NRF54H20_CPUAPP
	depends on IRONSIDE_SE_CALL
	help
	  Support for changing the DVFS operating point.

if IRONSIDE_SE_DVFS

config IRONSIDE_SE_DVFS_ABB_STATUSANA_CHECK_MAX_ATTEMPTS
	int "ABB analog status check maximum attempts"
	range 0 255
	default 50
	help
	  Maximum attempts with 10us intervals before busy status will be reported.

endif # IRONSIDE_SE_DVFS

menuconfig NRF_PERIPHCONF_SECTION
	bool "Global peripheral initialization section"
	depends on LINKER_DEVNULL_SUPPORT
	help
	  Include static global domain peripheral initialization values from the
	  build in a dedicated section. The section is either stripped from the
	  firmware binary or kept as constant data, depending on how it will be
	  loaded at runtime.

if NRF_PERIPHCONF_SECTION

config NRF_PERIPHCONF_SECTION_STRIP
	bool "Strip the section from the binary"
	default y if !NRF_PERIPHCONF_SECTION_KEEP_BY_DEFAULT
	imply LINKER_DEVNULL_MEMORY
	help
	  Strip the PERIPHCONF section from the firmware binary.
	  If the UICR generator image is enabled, it will include the stripped section
	  in the generated UICR PERIPHCONF blob.

	  When this is disabled, the PERIPHCONF section will remain as data in the binary,
	  and will not included in the UICR PERIPHCONF blob. Instead, it is expected that
	  it will be loaded via the ironside_se_periphconf_write() API.

config NRF_PERIPHCONF_GENERATE_ENTRIES
	bool "Generate PERIPHCONF entries source file"
	default y
	help
	  Generate a C file containing PERIPHCONF entries based on the
	  device configuration in the devicetree.

config NRF_PERIPHCONF_GENERATE_ENTRIES_LOCK
	bool "Lock registers in PERIPHCONF"
	default y
	depends on NRF_PERIPHCONF_GENERATE_ENTRIES
	help
	  Set the lock bit in registers that support it.
	  Disable this to allow the registers to be reconfigured after boot.

endif # NRF_PERIPHCONF_SECTION

config NRF_PERIPHCONF_SECTION_KEEP_BY_DEFAULT
	bool "Keep the PERIPHCONF section by default (set by build system)"
	help
	  This is set from Sysbuild to change the default behavior for the image so that
	  CONFIG_NRF_PERIPHCONF_SECTION_STRIP=n unless explicitly configured otherwise.
	  To override this behavior, set CONFIG_NRF_PERIPHCONF_SECTION_STRIP=y directly.

endmenu # IronSide SE
