# Copyright (c) 2025 Nordic Semiconductor ASA
# SPDX-License-Identifier: Apache-2.0

config HAS_IRONSIDE_SE
	bool

menu "IronSide SE"
	depends on HAS_IRONSIDE_SE

config IRONSIDE_SE_CALL
	bool "IronSide calls"
	default y
	depends on DT_HAS_NORDIC_IRONSIDE_CALL_ENABLED
	depends on MULTITHREADING
	select EVENTS
	select MBOX
	help
	  Support for IronSide call APIs.

if IRONSIDE_SE_CALL

config IRONSIDE_SE_CALL_INIT_PRIORITY
	int "IronSide calls' driver initialization priority"
	default 41
	help
	  Initialization priority of the IronSide call protocol driver.
	  It must be below MBOX_INIT_PRIORITY, but higher than the priority of any feature
	  that depends on IRONSIDE_SE_CALL.

endif # IRONSIDE_SE_CALL

config IRONSIDE_SE_DVFS
	bool "DVFS support"
	depends on SOC_NRF54H20_CPUAPP
	depends on IRONSIDE_SE_CALL
	help
	  Support for changing the DVFS operating point.

if IRONSIDE_SE_DVFS

config IRONSIDE_SE_DVFS_ABB_STATUSANA_CHECK_MAX_ATTEMPTS
	int "ABB analog status check maximum attempts"
	range 0 255
	default 50
	help
	  Maximum attempts with 10us intervals before busy status will be reported.

endif # IRONSIDE_SE_DVFS

menuconfig NRF_PERIPHCONF_SECTION
	bool "Global peripheral initialization section"
	depends on LINKER_DEVNULL_SUPPORT
	help
	  Include static global domain peripheral initialization values from the
	  build in a dedicated section. The section is either stripped from the
	  firmware binary or kept as constant data, depending on how it will be
	  loaded at runtime.

if NRF_PERIPHCONF_SECTION

config NRF_PERIPHCONF_SECTION_STRIP
	bool
	default y
	depends on !NRF_PERIPHCONF_SECTION_KEEP
	imply LINKER_DEVNULL_MEMORY
	help
	  Strip the PERIPHCONF section from the firmware binary.

config NRF_PERIPHCONF_SECTION_KEEP
	bool "Keep the section in the binary"
	default y if NRF_PERIPHCONF_SECTION_KEEP_BY_DEFAULT
	help
	  Keep the PERIPHCONF section as data in the firmware binary.

config NRF_PERIPHCONF_GENERATE_ENTRIES
	bool "Generate PERIPHCONF entries source file"
	default y
	help
	  Generate a C file containing PERIPHCONF entries based on the
	  device configuration in the devicetree.

config NRF_PERIPHCONF_GENERATE_ENTRIES_NO_LOCK
	bool "Don't lock registers in PERIPHCONF"
	help
	  Don't set the lock bit in registers that support it (SPU registers).
	  This is needed when the registers are reconfigured after boot.

endif # NRF_PERIPHCONF_SECTION

config NRF_PERIPHCONF_SECTION_KEEP_BY_DEFAULT
	bool "Keep the PERIPHCONF section by default (set by Sysbuild, do not change)"
	help
	  This is set by Sysbuild to change the default behavior for the image so that
	  NRF_PERIPHCONF_SECTION_KEEP is set unless explicitly configured otherwise.

endmenu # IronSide SE
